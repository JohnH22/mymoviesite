{% extends 'movie/base.html' %}
{% load static %}
{% load movie_extras %}

{% block content %}
<div class="p-5 mb-5 text-white rounded-3 shadow-lg welcome-header">
    <div class="container-fluid py-5 text-center">
        <h1 class="display-3 fw-bold text-uppercase welcome-title">
            Cinema World
        </h1>
        <p class="col-md-8 fs-4 mx-auto mb-4 fw-bold welcome-subtitle">
            Your ultimate destination for movie reviews, classics, and new releases.
        </p>
        <a href="#movies-list" class="btn btn-warning btn-lg px-5 fw-bold text-uppercase shadow">
            Browse Collection
        </a>
    </div>
</div>

<div id="movies-list" class="container mt-5">
    <h2 class="pb-3 border-bottom text-uppercase fw-bold text-dark mb-4">
        <span class="badge bg-warning text-dark me-2">NEW</span> Recent Releases
    </h2>

    <div class="row row-cols-1 row-cols-md-3 g-4">
        {% for movie in page_obj %}
        <div class="col">
            <div class="card h-100 shadow film-card">

                <div class="position-relative">
                    {% if movie.image %}
                        <img src="{{ movie.image.url }}" class="card-image-main" alt="{{ movie.title }}">
                    {% endif %}

                    <span class="position-absolute top-0 end-0 m-2 badge rounded-pill rating-badge">
                        <i class="bi bi-star-fill text-warning"></i>
                        {% if movie.display_rating %}
                            {{ movie.display_rating|floatformat:1 }}
                        {% else %}
                            N/A
                        {% endif %}
                    </span>
                </div>

                <div class="card-body custom-card p-4">
                    <h5 class="movie-card-title mb-3">{{ movie.title }}</h5>

                    <div class="info-movie-group">
                        <div class="info-line">
                            <i class="bi bi-calendar-check-fill text-primary me-2"></i>
                            <span class="text-muted fw-bold small">Date:</span>
                            <span class="small ms-2">{{ movie.release_date|date:"Y" }}</span>
                        </div>

                        <div class="info-line">
                            <i class="bi bi-film text-danger me-2"></i>
                            <span class="text-muted fw-bold small">Category:</span>
                            <span class="small ms-2">{{ movie.category.name }}</span>
                        </div>

                        {% if movie.duration %}
                        <div class="info-line">
                            <i class="bi bi-clock-history text-warning me-2"></i>
                            <span class="text-muted fw-bold small">Duration:</span>
                            <span class="small ms-2"> {{ movie.duration|format_duration }} </span>
                        </div>
                        {% endif %}

                    <div class="info-line">
                        <i class="bi bi-star-fill movie-list-written-by-icon me-2"></i>
                        <span class="text-muted fw-bold small">Director:</span>
                        <span class="small ms-2">
                            {% if movie.director %}
                                {{ movie.director.name }}
                            {% else %}
                                Unknown
                            {% endif %}
                        </span>
                    </div>
                </div>
            </div>
                    <p class="movie-description">
                        <i class="bi bi-quote text-silver"></i> {{ movie.text|truncatewords:15 }}
                    </p>

                <div class="card-footer bg-transparent border-0 pb-4">
                    <a href="{% url 'movie_detail' pk=movie.pk %}" class="btn detail-movie-btn w-100 py-2 shadow-sm fw-bold">
                        <i class="bi bi-eye me-2"></i> VIEW DETAILS
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    <nav aria-label="Page navigation" class="mt-5 mb-5">
        <ul class="pagination justify-content-center border-0">

            {% if page_obj.has_previous %}
                <li class="page-item">
                    <a class="page-link custom-pagination-btn"
                       href="?page=1{% if current_txt %}&txt={{ current_txt }} {% endif %} {% if current_cat %}&cat={{ current_cat }} {% endif %} {% if current_dir %}&dir={{ current_dir }} {% endif %}">
                       <i class="bi bi-chevron-double-left"></i> First
                    </a>
                </li>
            {% endif %}

            <li class="page-item disabled">
                <span class="page-link custom-pagination-info">
                    Page <span class="text-warning fw-bold"> {{ page_obj.number }}</span> of {{ page_obj.paginator.num_pages }}
                </span>
            </li>

            {% if page_obj.has_next %}
                <li class="page-item">
                    <a class="page-link custom-pagination-btn"
                       href="?page={{ page_obj.next_page_number }}{% if current_txt %}&txt={{ current_txt }} {% endif %} {% if current_cat %}&cat={{ current_cat }} {% endif %} {% if current_dir %}&dir={{ current_dir }} {% endif %}">
                       Next
                    </a>
                </li>
                <li class="page-item">
                    <a class="page-link custom-pagination-btn"
                       href="?page={{ page_obj.paginator.num_pages }}{% if current_txt %}&txt={{ current_txt }} {% endif %} {% if current_cat %}&cat={{ current_cat }} {% endif %} {% if current_dir %}&dir={{ current_dir }} {% endif %}">
                        Last <i class="bi bi-chevron-double-right"></i>
                    </a>
                </li>
            {% endif %}

        </ul>
    </nav>
</div>
{% endblock content %}